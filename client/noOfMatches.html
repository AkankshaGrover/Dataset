
<html>
<head>
    <title>Highcharts Tutorial</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://code.highcharts.com/highcharts.js"></script>
    <link rel="stylesheet" href="./noOfMatches.css">
</head>
<body>
    <div class="buttons">
        <button id="container5" class="btn">All Wins</button> 
        <button id="container1" class="btn">Matches Won</button>
        <button id="container2" class="btn">Extra Runs</button>
        <button id="container3" class="btn">Top Bowlers</button>
        <button id="container4" class="btn">Wins of kings XI</button>
    </div> 
    <div id ="container"> 
    </div>
    <script language="JavaScript">
        $(document).ready(function () {
            $('#container5').click(function(){
            fetch("http://localhost:3000/allWins").then((res) => res.json())
                .then(function (map) {
                    let yr = [];
                    let matches =[]
                    for (i in map) {
                        yr[i] = Object.values(map)[i];
                        matches[i] = Object.keys(map)[i];
                    }
                    $('#container').highcharts({
                        chart: {
                            type: "line"
                        },
                        title: {
                            text: "Number of matches played per year of all the years"
                            
                        },                       
                        xAxis: {
                            type: 'category',
                            allowDecimals: false,
                            title: {
                                text: "Years"
                            },
                            categories: yr //Object.keys(map).map((key) => String(key))
                        },
                        yAxis: {
                            title: {
                                text: "Matches played"
                            },
                            categories: matches
                        },
                        series: [{
                         //   name: Object.keys(map).map((key) => String(key)),
                        // name : yr,
                            data: Object.values(map).map((key) => Number(key))
                        }]
                    });
                })
                })
                   
             $('#container1').click(function () {
             fetch("http://localhost:3000/matchesWon").then((res) => res.json())
                  .then(function (obj) {  
                      
                    let set = new Set();
                    let arr =[];
                   
                    let years = Object.keys(obj);
                    let wins = Object.values(obj);
                    for(let i of wins)
                    {
                        let arr = Object.keys(i);
                        for(let name of arr)
                        {
                            set.add(name);
                        }
                    }
                    
                  //  debugger;
                    let team = Array.from(set);
                  //  debugger;
                    for(let name of team)
                    {
                         let a = [];
                        for(let item of wins)
                        {
                            if(item[name]!= undefined)
                                a.push(item[name]);
                            else
                                a.push(0);
                        }
                        arr.push({"name":name, "data":a});
                    }
                    console.log(arr);
                    $('#container').highcharts({
                        chart: {
                            type: 'column'
                        },
                        title: {

                            text: 'Stacked bar chart'
                        },
                        xAxis: {
                            type: "category",
                            allowDecimals: false,
                            categories:years
                        },
                        yAxis: {
                            min: 0,
                            title: {
                                text: 'Number of matches won'
                            }
                        },
                        legend: {
                            reversed: true
                        },
                        plotOptions: {
                            series: {
                                stacking: 'normal'
                            }
                        },
                        series: arr
                    });
                })
            })

             $('#container2').click(function () {    
            fetch("http://localhost:3000/extraRuns").then((res) => res.json())
                .then(function (map1) {
                    $('#container').highcharts({
                        chart: {
                            type: "column"
                        },
                        title: {
                            text: "Extra runs conceeded per year"
                            
                        },                       
                        xAxis: {
                            type: 'category',
                            allowDecimals: false,
                            title: {
                                text: "Teams"
                            },
                             categories: Object.keys(map1).map((key) => String(key))
                        },
                        yAxis: {
                            title: {
                                text: "Years"
                            },
                            categories: map1
                        },
                        series: [{
                            name: Object.keys(map1).map((key)=>String(key)),
                            data: Object.values(map1).map((key) => Number(key))
                        }]
                    });
                })
            })

            $('#container3').click(function () {
                fetch("http://localhost:3000/topBowlers").then((res) => res.json())
                .then(function (map) {
                    let names = [];
                    let eco = [];
                    for (let i in map)
                    {
                        names[i] = Object.values(map)[i].name;
                        eco[i] = Object.values(map)[i].economy;
                    }
                    $('#container').highcharts({
                        
                        chart: {
                            type: "line"
                        },
                        title: {
                            text: "Top Economical Bowlers of 2015"

                        },
                        xAxis: {
                            type: 'category',
                            allowDecimals: false,
                            title: {
                                text: "Names"
                            },
                            categories: names
                        },
                        yAxis: {
                            title: {
                                text: "Economy"
                            },
                            categories: eco
                        },
                        series: [{
                           /// name: //Object.keys(map).map((key) => String(key)),
                            data: eco//.map((key) => Number(key))
                        }]
                    });
                })
            })
                $('#container4').click(function () {
                fetch("http://localhost:3000/kingsXI").then((res) => res.json())
                .then(function (map) {
                    debugger;
                    $('#container').highcharts({
                        
                        chart: {
                            type: "line"
                        },
                        title: {
                            text: "Wins of Kings XI Punjab"

                        },
                        xAxis: {
                            type: 'category',
                            allowDecimals: false,
                            title: {
                                text: "Years"
                            },
                         categories: Object.keys(map).map((key) => String(key))
                        },
                        yAxis: {
                            title: {
                                text: "Wins"
                            },
                           // categories: Object.keys(map).map((key) => String(key))
                        },
                        series: [{
                            
                            data: Object.values(map).map((key) => Number(key)),
                            // name: Object.keys(map).map((key) => String(key))
                           
                        }]
                    });
                })
            })
            })
    </script>
</body>
</html>